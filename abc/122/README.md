# ABC122

## D
カテゴリ: 動的計画法

dp[i][s]を満たす文字列の数とする。

* 長さは i
* 末尾3文字は s

さらに、T を長さ3のACGT文字列の集合とする。
さらに、 4文字の文字列 t について、 t が問題の条件を満たす文字列ならば真、
そうでなければ偽となる述語を P(t) とする。
このとき、

* i = 3, s = 'AGC', 'ACG', 'GAC' について、 dp[i][s] = 0
* i = 3, s != 'AGC', 'ACG', 'GAC' について、 dp[i][s] = 1
* i >= 4　について dp[i][s] = sum(dp[i -1][t] for t in T if t[2:3] = s[1:2] and P(t + s[3])

である。
解は `sum(dp[N][T] for t in T) % (10^9 + 7)` である。
