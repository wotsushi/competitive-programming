# AGC028

## B
カテゴリ: 数学

N回の操作のコストの期待値を E_N とする。
一列に並んだ n 個のブロックに対して、n回の操作で左から i番目の ブロックに対してコストを支払う回数の期待値を E[i]_n とする。 i = 1 について、以下の漸化式が成り立つ。

* E[1]_1 = 1
* E[1]_n = 1 + (E[1]_{n - 1} + E[1]_{n - 2} + ... + E[1]_{1}) / n

これを解くと、 E[1]_n = 1 + 1/2 + 1/3 + ... + 1/n を得る。
さらに、 i >= 2 について、以下の漸化式が成り立つ。

* E[i]_i = E[1]_n
* E[i]_n = 1 + (E[i - 1]_{n - 1} + E[i - 2]_{n - 2} + ... + E[1]_{n - i}) / n +
(E[i]_{n - 1} + E[i]_{n - 2} + ... + E[i]_{i}) / n

これを解くと、E[i]_n = (1 + 1/2 + ... + 1/(n - i + 1)) + (1 + 1/2 + ... + 1/i) - 1 を得る。
解は (N! (A_1 E[1]_N + A_2 E[2]_N + ... + A_N E[N]_N)) % (10**9 + 7) である。
