# AGC038

## A
カテゴリ: 構築

A個の0とW - A個の1を連ねた行をB個連ねる。
その後、A個の1とW - A個の0を連ねた行を(H-B)個連ねればよい。

## B
カテゴリ: スライド最小値

要素列 (P_i, ..., P_{i + K - 1}) を Q[i:] で表す。
操作対象の要素列は Q[0:], Q[1:], ..., Q[N - K:] の N - K + 1 個ある。
これらの操作後の順列のうち、並び替え後の順列が一致するものはいくつあるかを数えられればよい。

まず、Q[0:]に対する操作とQ[1:]に対する操作について、並び替え後の順列が一致する条件を考えよう。
前者の操作後に P_0 が移動した場合、後者とは異なる順列になってしまう。
同様に、後者の操作後に P_K が移動した場合、前者とは異なる順列になってしまう。
したがって、 両者の操作後の順列が一致するならば、 P_0 = min(Q[0:]), P_K = max(Q[1:]) を満たす。
逆に、これらを満たすならば両者の操作後の順列が一致することも分かる。

他の要素列に対する操作対についても同様に考察できる。
ここで、 Q[i:], Q[j:] (i < j)に対して操作した後の順列が一致するならば以下のどちらかが成り立つことに留意する。

* Q[i:], Q[j:] は昇順ソートされている
* Q[i+1:], Q[i+2:], ..., Q[j - 1:] に対する操作後の順列は等しい

以上より、以下の手順で解を求められる。

1. Q[0:], Q[1:], ..., Q[N - K:]のうち、昇順ソートされている列の開始インデックスの集合をIとする（カウントしながら先頭から走査することで線形時間でIを得られる）
1. 解を表すカウントaを0とする。
1. Q[0:] の最小値をm, 最大値をMとする。
1. 0がIに属さないならばaを1増やす。
1. Q[1:] の最小値をm', 最大値をM'とする。
1. (m != P_0 または M' != P_K) かつ1がIに属さないならばaを1増やす。
1. m = m', M = M' とする。
1. Q[2:] の最小値をm', 最大値をM'とする。
1. (m != P_1 または M' != P_{K + 1}) かつ2がIに属さないならばaを1増やす。
1. m = m', M = M' とする。
1. ...
1. Q[i:] の最小値をm', 最大値をM'とする。
1. (m != P_{i - 1} または M' != P_{K + i - 1}) かつiがIに属さないならばaを1増やす。
1. m = m', M = M' とする。
1. ...
1. Q[N - K:] の最小値をm', 最大値をM'とする。
1. (m != P_{N - K - 1} または M' != P_{N - 1}) かつN - KがIに属さないならばaを1増やす。
1. Iが空でないならばaを1増やす（変化しない操作をカウントする）。
1. a を解とする

各m', M'は[スライド最小値](http://phwinx.hatenablog.com/entry/2018/11/17/042646)を用いることで効率的に求められる。
